/* eslint-disable */
//prettier-ignore
module.exports = {
name: "@yarnpkg/plugin-spdx",
factory: function (require) {
var plugin=(()=>{var Kt=Object.create;var te=Object.defineProperty;var Wt=Object.getOwnPropertyDescriptor;var $t=Object.getOwnPropertyNames;var Zt=Object.getPrototypeOf,Qt=Object.prototype.hasOwnProperty;var m=(t=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(t,{get:(e,r)=>(typeof require<"u"?require:e)[r]}):t)(function(t){if(typeof require<"u")return require.apply(this,arguments);throw new Error('Dynamic require of "'+t+'" is not supported')});var g=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),re=(t,e)=>{for(var r in e)te(t,r,{get:e[r],enumerable:!0})},Ye=(t,e,r,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of $t(e))!Qt.call(t,i)&&i!==r&&te(t,i,{get:()=>e[i],enumerable:!(n=Wt(e,i))||n.enumerable});return t};var Xe=(t,e,r)=>(r=t!=null?Kt(Zt(t)):{},Ye(e||!t||!t.__esModule?te(r,"default",{value:t,enumerable:!0}):r,t)),er=t=>Ye(te({},"__esModule",{value:!0}),t);var Ne=g(_e=>{"use strict";Object.defineProperty(_e,"__esModule",{value:!0});_e.default=nr;var tr=rr(m("crypto"));function rr(t){return t&&t.__esModule?t:{default:t}}var oe=new Uint8Array(256),ie=oe.length;function nr(){return ie>oe.length-16&&(tr.default.randomFillSync(oe),ie=0),oe.slice(ie,ie+=16)}});var Ke=g(se=>{"use strict";Object.defineProperty(se,"__esModule",{value:!0});se.default=void 0;var ir=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;se.default=ir});var K=g(ae=>{"use strict";Object.defineProperty(ae,"__esModule",{value:!0});ae.default=void 0;var or=sr(Ke());function sr(t){return t&&t.__esModule?t:{default:t}}function ar(t){return typeof t=="string"&&or.default.test(t)}var cr=ar;ae.default=cr});var $=g(W=>{"use strict";Object.defineProperty(W,"__esModule",{value:!0});W.default=void 0;W.unsafeStringify=We;var dr=ur(K());function ur(t){return t&&t.__esModule?t:{default:t}}var p=[];for(let t=0;t<256;++t)p.push((t+256).toString(16).slice(1));function We(t,e=0){return p[t[e+0]]+p[t[e+1]]+p[t[e+2]]+p[t[e+3]]+"-"+p[t[e+4]]+p[t[e+5]]+"-"+p[t[e+6]]+p[t[e+7]]+"-"+p[t[e+8]]+p[t[e+9]]+"-"+p[t[e+10]]+p[t[e+11]]+p[t[e+12]]+p[t[e+13]]+p[t[e+14]]+p[t[e+15]]}function lr(t,e=0){let r=We(t,e);if(!(0,dr.default)(r))throw TypeError("Stringified UUID is invalid");return r}var fr=lr;W.default=fr});var Ze=g(ce=>{"use strict";Object.defineProperty(ce,"__esModule",{value:!0});ce.default=void 0;var mr=gr(Ne()),pr=$();function gr(t){return t&&t.__esModule?t:{default:t}}var $e,Te,Re=0,Fe=0;function xr(t,e,r){let n=e&&r||0,i=e||new Array(16);t=t||{};let o=t.node||$e,c=t.clockseq!==void 0?t.clockseq:Te;if(o==null||c==null){let d=t.random||(t.rng||mr.default)();o==null&&(o=$e=[d[0]|1,d[1],d[2],d[3],d[4],d[5]]),c==null&&(c=Te=(d[6]<<8|d[7])&16383)}let a=t.msecs!==void 0?t.msecs:Date.now(),l=t.nsecs!==void 0?t.nsecs:Fe+1,u=a-Re+(l-Fe)/1e4;if(u<0&&t.clockseq===void 0&&(c=c+1&16383),(u<0||a>Re)&&t.nsecs===void 0&&(l=0),l>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");Re=a,Fe=l,Te=c,a+=122192928e5;let f=((a&268435455)*1e4+l)%4294967296;i[n++]=f>>>24&255,i[n++]=f>>>16&255,i[n++]=f>>>8&255,i[n++]=f&255;let s=a/4294967296*1e4&268435455;i[n++]=s>>>8&255,i[n++]=s&255,i[n++]=s>>>24&15|16,i[n++]=s>>>16&255,i[n++]=c>>>8|128,i[n++]=c&255;for(let d=0;d<6;++d)i[n+d]=o[d];return e||(0,pr.unsafeStringify)(i)}var hr=xr;ce.default=hr});var Le=g(de=>{"use strict";Object.defineProperty(de,"__esModule",{value:!0});de.default=void 0;var Dr=Pr(K());function Pr(t){return t&&t.__esModule?t:{default:t}}function Sr(t){if(!(0,Dr.default)(t))throw TypeError("Invalid UUID");let e,r=new Uint8Array(16);return r[0]=(e=parseInt(t.slice(0,8),16))>>>24,r[1]=e>>>16&255,r[2]=e>>>8&255,r[3]=e&255,r[4]=(e=parseInt(t.slice(9,13),16))>>>8,r[5]=e&255,r[6]=(e=parseInt(t.slice(14,18),16))>>>8,r[7]=e&255,r[8]=(e=parseInt(t.slice(19,23),16))>>>8,r[9]=e&255,r[10]=(e=parseInt(t.slice(24,36),16))/1099511627776&255,r[11]=e/4294967296&255,r[12]=e>>>24&255,r[13]=e>>>16&255,r[14]=e>>>8&255,r[15]=e&255,r}var Ir=Sr;de.default=Ir});var we=g(O=>{"use strict";Object.defineProperty(O,"__esModule",{value:!0});O.URL=O.DNS=void 0;O.default=Cr;var Er=$(),kr=yr(Le());function yr(t){return t&&t.__esModule?t:{default:t}}function Ar(t){t=unescape(encodeURIComponent(t));let e=[];for(let r=0;r<t.length;++r)e.push(t.charCodeAt(r));return e}var Qe="6ba7b810-9dad-11d1-80b4-00c04fd430c8";O.DNS=Qe;var et="6ba7b811-9dad-11d1-80b4-00c04fd430c8";O.URL=et;function Cr(t,e,r){function n(i,o,c,a){var l;if(typeof i=="string"&&(i=Ar(i)),typeof o=="string"&&(o=(0,kr.default)(o)),((l=o)===null||l===void 0?void 0:l.length)!==16)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");let u=new Uint8Array(16+i.length);if(u.set(o),u.set(i,o.length),u=r(u),u[6]=u[6]&15|e,u[8]=u[8]&63|128,c){a=a||0;for(let f=0;f<16;++f)c[a+f]=u[f];return c}return(0,Er.unsafeStringify)(u)}try{n.name=t}catch{}return n.DNS=Qe,n.URL=et,n}});var tt=g(ue=>{"use strict";Object.defineProperty(ue,"__esModule",{value:!0});ue.default=void 0;var vr=Or(m("crypto"));function Or(t){return t&&t.__esModule?t:{default:t}}function _r(t){return Array.isArray(t)?t=Buffer.from(t):typeof t=="string"&&(t=Buffer.from(t,"utf8")),vr.default.createHash("md5").update(t).digest()}var Nr=_r;ue.default=Nr});var nt=g(le=>{"use strict";Object.defineProperty(le,"__esModule",{value:!0});le.default=void 0;var Tr=rt(we()),Rr=rt(tt());function rt(t){return t&&t.__esModule?t:{default:t}}var Fr=(0,Tr.default)("v3",48,Rr.default),Lr=Fr;le.default=Lr});var it=g(fe=>{"use strict";Object.defineProperty(fe,"__esModule",{value:!0});fe.default=void 0;var wr=Mr(m("crypto"));function Mr(t){return t&&t.__esModule?t:{default:t}}var br={randomUUID:wr.default.randomUUID};fe.default=br});var at=g(me=>{"use strict";Object.defineProperty(me,"__esModule",{value:!0});me.default=void 0;var ot=st(it()),Vr=st(Ne()),Ur=$();function st(t){return t&&t.__esModule?t:{default:t}}function Hr(t,e,r){if(ot.default.randomUUID&&!e&&!t)return ot.default.randomUUID();t=t||{};let n=t.random||(t.rng||Vr.default)();if(n[6]=n[6]&15|64,n[8]=n[8]&63|128,e){r=r||0;for(let i=0;i<16;++i)e[r+i]=n[i];return e}return(0,Ur.unsafeStringify)(n)}var qr=Hr;me.default=qr});var ct=g(pe=>{"use strict";Object.defineProperty(pe,"__esModule",{value:!0});pe.default=void 0;var Br=Yr(m("crypto"));function Yr(t){return t&&t.__esModule?t:{default:t}}function Xr(t){return Array.isArray(t)?t=Buffer.from(t):typeof t=="string"&&(t=Buffer.from(t,"utf8")),Br.default.createHash("sha1").update(t).digest()}var Jr=Xr;pe.default=Jr});var ut=g(ge=>{"use strict";Object.defineProperty(ge,"__esModule",{value:!0});ge.default=void 0;var jr=dt(we()),zr=dt(ct());function dt(t){return t&&t.__esModule?t:{default:t}}var Gr=(0,jr.default)("v5",80,zr.default),Kr=Gr;ge.default=Kr});var lt=g(xe=>{"use strict";Object.defineProperty(xe,"__esModule",{value:!0});xe.default=void 0;var Wr="00000000-0000-0000-0000-000000000000";xe.default=Wr});var ft=g(he=>{"use strict";Object.defineProperty(he,"__esModule",{value:!0});he.default=void 0;var $r=Zr(K());function Zr(t){return t&&t.__esModule?t:{default:t}}function Qr(t){if(!(0,$r.default)(t))throw TypeError("Invalid UUID");return parseInt(t.slice(14,15),16)}var en=Qr;he.default=en});var mt=g(S=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0});Object.defineProperty(S,"NIL",{enumerable:!0,get:function(){return sn.default}});Object.defineProperty(S,"parse",{enumerable:!0,get:function(){return un.default}});Object.defineProperty(S,"stringify",{enumerable:!0,get:function(){return dn.default}});Object.defineProperty(S,"v1",{enumerable:!0,get:function(){return tn.default}});Object.defineProperty(S,"v3",{enumerable:!0,get:function(){return rn.default}});Object.defineProperty(S,"v4",{enumerable:!0,get:function(){return nn.default}});Object.defineProperty(S,"v5",{enumerable:!0,get:function(){return on.default}});Object.defineProperty(S,"validate",{enumerable:!0,get:function(){return cn.default}});Object.defineProperty(S,"version",{enumerable:!0,get:function(){return an.default}});var tn=k(Ze()),rn=k(nt()),nn=k(at()),on=k(ut()),sn=k(lt()),an=k(ft()),cn=k(K()),dn=k($()),un=k(Le());function k(t){return t&&t.__esModule?t:{default:t}}});var Xn={};re(Xn,{default:()=>Yn});var Lt=m("@yarnpkg/cli");function b(t){return t.toISOString().split(".")[0]+"Z"}var V=class{created;creators;comment;licenseListVersion;constructor(e,r,n,i){this.created=e,this.creators=r,this.comment=n,this.licenseListVersion=i}static fromDocument(e){return new V(b(e.creationInfo.created),e.creationInfo.creators.map(r=>r.toString()),e.creationInfo.creatorComment??void 0,e.creationInfo.licenseListVersion??void 0)}};var I=class{algorithm;checksumValue;constructor(e,r){this.algorithm=e,this.checksumValue=r}static fromChecksum(e){return new I(e.algorithm,e.value)}};var U=class{packageVerificationCodeValue;packageVerificationCodeExcludedFiles;constructor(e,r){this.packageVerificationCodeValue=e,this.packageVerificationCodeExcludedFiles=r}static fromPackageVerificationCode(e){return new U(e.value,e.excludedFiles)}};var H=class{comment;referenceCategory;referenceLocator;referenceType;constructor(e,r,n,i){this.referenceCategory=e,this.referenceLocator=r,this.referenceType=n,this.comment=i}static fromExternalPackageRef(e){return new H(e.category.toString(),e.locator,e.type,e.comment)}};var q=class{name;downloadLocation;SPDXID;filesAnalyzed;packageVerificationCode;checksums;licenseInfoFromFiles;externalRefs;attributionTexts;builtDate;comment;copyrightText;description;homepage;licenseComments;licenseConcluded;licenseDeclared;originator;packageFileName;primaryPackagePurpose;releaseDate;sourceInfo;summary;supplier;validUntilDate;versionInfo;constructor(e,r,n,i,o,c,a,l,u,f,s,d,ye,Mt,bt,Vt,Ut,Ht,qt,Bt,Yt,Xt,Jt,jt,zt,Gt){this.name=e,this.downloadLocation=r,this.SPDXID=n,this.filesAnalyzed=i,this.packageVerificationCode=o,this.checksums=c,this.licenseInfoFromFiles=a,this.externalRefs=l,this.attributionTexts=u,this.builtDate=f,this.comment=s,this.copyrightText=d,this.description=ye,this.homepage=Mt,this.licenseComments=bt,this.licenseConcluded=Vt,this.licenseDeclared=Ut,this.originator=Ht,this.packageFileName=qt,this.primaryPackagePurpose=Bt,this.releaseDate=Yt,this.sourceInfo=Xt,this.summary=Jt,this.supplier=jt,this.validUntilDate=zt,this.versionInfo=Gt}static fromPackage(e){let r=e.checksums.length>0?e.checksums.map(o=>I.fromChecksum(o)):void 0,n=e.verificationCode?U.fromPackageVerificationCode(e.verificationCode):void 0,i=e.externalReferences?.length>0?e.externalReferences.map(o=>H.fromExternalPackageRef(o)):void 0;return new q(e.name,e.downloadLocation.toString(),e.spdxId,e.filesAnalyzed,n,r,e.licenseInfoFromFiles.map(o=>o.toString()),i,e.attributionTexts.length>0?e.attributionTexts:void 0,e.builtDate?b(e.builtDate):void 0,e.comment,e.copyrightText?.toString(),e.description,e.homepage?.toString(),e.licenseComment,e.licenseConcluded?.toString(),e.licenseDeclared?.toString(),e.originator?.toString(),e.fileName,e.primaryPackagePurpose?.toString(),e.releaseDate?b(e.releaseDate):void 0,e.sourceInfo,e.summary,e.supplier?.toString(),e.validUntilDate?b(e.validUntilDate):void 0,e.version)}};var B=class{spdxElementId;relatedSpdxElement;relationshipType;comment;constructor(e,r,n,i){this.spdxElementId=e,this.comment=i,this.relatedSpdxElement=r,this.relationshipType=n}static fromRelationship(e){return new B(e.spdxElementId,e.relatedSpdxElementId,e.relationshipType)}};var Y=class{checksum;externalDocumentId;spdxDocument;constructor(e,r,n){this.checksum=e,this.externalDocumentId=r,this.spdxDocument=n}static fromExternalDocumentRef(e){let r=I.fromChecksum(e.checksum);return new Y(r,e.documentRefId,e.documentUri)}};var X=class{SPDXID;fileName;checksums;attributionTexts;comment;copyrightText;fileContributors;fileTypes;licenseComments;licenseConcluded;licenseInfoInFiles;noticeText;constructor(e,r,n,i,o,c,a,l,u,f,s,d){this.SPDXID=e,this.fileName=r,this.checksums=n,this.attributionTexts=i,this.comment=o,this.copyrightText=c,this.fileContributors=a,this.fileTypes=l,this.licenseComments=u,this.licenseConcluded=f,this.licenseInfoInFiles=s,this.noticeText=d}static fromFile(e){let r=e.checksums.map(o=>I.fromChecksum(o)),n=e.fileTypes.length>0?e.fileTypes.map(o=>o.toString()):void 0,i=e.licenseInfoInFiles.length>0?e.licenseInfoInFiles.map(o=>o.toString()):void 0;return new X(e.spdxId,e.name,r,e.attributionTexts.length>0?e.attributionTexts:void 0,e.comment,e.copyrightText?.toString(),e.contributors.length>0?e.contributors:void 0,n,e.licenseComment,e.licenseConcluded?.toString(),i,e.notice)}};var J=class{SPDXID;comment;creationInfo;dataLicense;externalDocumentRefs;name;spdxVersion;documentNamespace;packages;files;relationships;constructor(e,r,n,i,o,c,a,l,u,f,s){this.SPDXID=e,this.spdxVersion=r,this.name=n,this.documentNamespace=i,this.dataLicense=o,this.creationInfo=c,this.packages=a,this.files=l,this.relationships=u,this.externalDocumentRefs=f,this.comment=s}static fromDocument(e){let r=V.fromDocument(e),n=e.packages.length>0?e.packages.map(a=>q.fromPackage(a)):void 0,i=e.files.length>0?e.files.map(a=>X.fromFile(a)):void 0,o=e.relationships.length>0?e.relationships.map(a=>B.fromRelationship(a)):void 0,c=e.creationInfo.externalDocumentRefs?.length>0?e.creationInfo.externalDocumentRefs.map(a=>Y.fromExternalDocumentRef(a)):void 0;return new J(e.creationInfo.spdxId,e.creationInfo.spdxVersion,e.creationInfo.name,e.creationInfo.documentNamespace,e.creationInfo.dataLicense,r,n,i,o,c,e.creationInfo.documentComment)}};var je=Xe(m("fs/promises"),1);function Je(t,e){return e.some(r=>t.has(r.spdxId)?!0:(t.add(r.spdxId),!1))}var A=class{creationInfo;packages;files;relationships;constructor(e,r){this.creationInfo=e,this.packages=r?.packages??[],this.files=r?.files??[],this.relationships=r?.relationships??[]}hasMissingDescribesRelationships(){let e=this.packages.length===1&&this.files.length===0,r=this.relationships.filter(i=>i.relationshipType==="DESCRIBES"),n=this.relationships.filter(i=>i.relationshipType==="DESCRIBED_BY");return!e&&r.length===0&&n.length===0}hasDuplicateSpdxIds(){let e=new Set([this.creationInfo.spdxId]);return Je(e,this.packages)||Je(e,this.files)}collectValidationIssues(){let e=[];return this.creationInfo.spdxVersion!=="SPDX-2.3"&&e.push("Invalid SPDX version. Currently only SPDX-2.3 is supported."),this.hasMissingDescribesRelationships()&&e.push(`Missing DESCRIBES or DESCRIBED_BY relationships.
Document must have at least one DESCRIBES and one DESCRIBED_BY relationship, if there is not exactly one package present.`),this.hasDuplicateSpdxIds()&&e.push("Duplicate SPDX IDs for document, packages or files."),e}async writeFile(e){let r=J.fromDocument(this),n=JSON.stringify(r,null,2);await je.default.writeFile(e,n)}};function ze(t){return typeof t=="string"?t:t instanceof A?t.creationInfo.spdxId:t.spdxId}var C=class{spdxElementId;relatedSpdxElementId;relationshipType;comment;constructor(e,r,n,i){this.spdxElementId=e,this.relatedSpdxElementId=r,this.relationshipType=n,this.comment=i?.comment}static fromApi(e,r,n,i){return new C(ze(e),ze(r),n,{comment:i?.comment})}};var Ae=(n=>(n.Person="Person",n.Organization="Organization",n.Tool="Tool",n))(Ae||{}),h=class{type;name;email;constructor(e,r,n){if(r==="Tool"&&n)throw new Error("Email must be undefined if actorType is Tool.");this.name=e,this.email=n??void 0,this.type=r}static fromSpdxActor(e){let r=Ae[e.type];if(!r)throw new Error("Invalid actor type: "+e.type);return new h(e.name,r,e.email)}static fromSpdxActors(e){return Array.isArray(e)?e.map(r=>h.fromSpdxActor(r)):[h.fromSpdxActor(e)]}static tools(){return new h("SPDX Tools TS","Tool")}toString(){return this.type.valueOf()+": "+this.name+(this.email?" ("+this.email+")":"")}};var Ce=(s=>(s.SHA1="SHA1",s.BLAKE3="BLAKE3",s["SHA3-384"]="SHA3-384",s.SHA256="SHA256",s.SHA384="SHA384",s["BLAKE2b-512"]="BLAKE2b-512",s["BLAKE2b-256"]="BLAKE2b-256",s["SHA3-512"]="SHA3-512",s.MD2="MD2",s.ADLER32="ADLER32",s.MD4="MD4",s["SHA3-256"]="SHA3-256",s["BLAKE2b-384"]="BLAKE2b-384",s.SHA512="SHA512",s.MD6="MD6",s.MD5="MD5",s.SHA224="SHA224",s))(Ce||{}),D=class{algorithm;value;constructor(e,r){this.algorithm=e,this.value=r}static fromSpdxChecksum(e){let r=Ce[e.checksumAlgorithm];if(!r)throw new Error("Invalid checksum algorithm: "+e.checksumAlgorithm);return new D(r,e.checksumValue)}static fromSpdxChecksums(e){return Array.isArray(e)?e.map(r=>D.fromSpdxChecksum(r)):[D.fromSpdxChecksum(e)]}};var ve="NOASSERTION",Oe="NONE",v=class{toString(){return ve}},ne=class{toString(){return Oe}};function P(t,e){let r=n=>n;return t===ve?new v:t===Oe?new ne:e?e(t):r(t)}function Ge(t){if(!(t instanceof v))throw new Error(`Invalid entry: ${t.toString()} is not allowed.`)}var E=Xe(mt(),1),bi=E.default.v1,Vi=E.default.v3,j=E.default.v4,Ui=E.default.v5,Hi=E.default.NIL,qi=E.default.version,Bi=E.default.validate,Yi=E.default.stringify,Xi=E.default.parse;var Me=(i=>(i.OTHER="OTHER",i["PERSISTENT-ID"]="PERSISTENT-ID",i.PERSISTENT_ID="PERSISTENT_ID",i.SECURITY="SECURITY",i["PACKAGE-MANAGER"]="PACKAGE-MANAGER",i.PACKAGE_MANAGER="PACKAGE_MANAGER",i))(Me||{}),_=class{category;type;locator;comment;constructor(e,r,n,i){this.category=e,this.type=r,this.locator=n,this.comment=i}static fromSpdxExternalPackageRefs(e){return e.map(r=>{let n=Me[r.referenceCategory];if(!n)throw new Error("Invalid external package reference category: "+r.referenceCategory);return new _(n,r.referenceType,r.referenceLocator,r.comment)})}};var be=(d=>(d.APPLICATION="APPLICATION",d.FRAMEWORK="FRAMEWORK",d.LIBRARY="LIBRARY",d.CONTAINER="CONTAINER",d.OPERATING_SYSTEM="OPERATING_SYSTEM",d.DEVICE="DEVICE",d.FIRMWARE="FIRMWARE",d.SOURCE="SOURCE",d.ARCHIVE="ARCHIVE",d.FILE="FILE",d.INSTALL="INSTALL",d.OTHER="OTHER",d))(be||{});function ln(t){let e=be[t];if(!e)throw new Error("Invalid package purpose: "+t);return e}function pt(t){if(t)if(typeof t=="string"){let e=P(t);return Ge(e),e}else{let e=h.fromSpdxActor(t);return fn(e),e}else return}function fn(t){if(t.type!=="Organization"&&t.type!=="Person")throw new Error(`Invalid vendor type: ${t.type}`)}var N=class{name;downloadLocation;spdxId;version;fileName;supplier;originator;filesAnalyzed;verificationCode;checksums;homepage;sourceInfo;licenseConcluded;licenseInfoFromFiles;licenseDeclared;licenseComment;copyrightText;summary;description;comment;externalReferences;attributionTexts;primaryPackagePurpose;releaseDate;builtDate;validUntilDate;constructor(e,r){this.name=e,this.downloadLocation=r?.downloadLocation??new v,this.spdxId=r?.spdxId??"SPDXRef-"+j(),this.version=r?.version??void 0,this.fileName=r?.fileName??void 0,this.supplier=r?.supplier??void 0,this.originator=r?.originator??void 0,this.filesAnalyzed=r?.filesAnalyzed??!1,this.verificationCode=r?.verificationCode??void 0,this.checksums=r?.checksums??[],this.homepage=r?.homepage??void 0,this.sourceInfo=r?.sourceInfo??void 0,this.licenseConcluded=r?.licenseConcluded??void 0,this.licenseInfoFromFiles=r?.licenseInfoFromFiles??[],this.licenseDeclared=r?.licenseDeclared??void 0,this.licenseComment=r?.licenseComment??void 0,this.copyrightText=r?.copyrightText??void 0,this.summary=r?.summary??void 0,this.description=r?.description??void 0,this.comment=r?.comment??void 0,this.externalReferences=r?.externalReferences??[],this.attributionTexts=r?.attributionTexts??[],this.primaryPackagePurpose=r?.primaryPackagePurpose??void 0,this.releaseDate=r?.releaseDate??void 0,this.builtDate=r?.builtDate??void 0,this.validUntilDate=r?.validUntilDate??void 0}static fromApi(e,r){return new N(e,{spdxId:r?.spdxId,version:r?.version,fileName:r?.fileName,downloadLocation:r?.downloadLocation&&P(r.downloadLocation),supplier:pt(r?.supplier),originator:pt(r?.originator),filesAnalyzed:r?.filesAnalyzed,verificationCode:r?.verificationCode,checksums:r?.checksums&&D.fromSpdxChecksums(r.checksums),homepage:r?.homepage&&P(r.homepage),sourceInfo:r?.sourceInfo,licenseConcluded:r?.licenseConcluded&&P(r.licenseConcluded),licenseInfoFromFiles:r?.licenseInfoFromFiles?.map(n=>P(n)),licenseDeclared:r?.licenseDeclared&&P(r.licenseDeclared),licenseComment:r?.licenseComment,copyrightText:r?.copyrightText&&P(r.copyrightText),summary:r?.summary,description:r?.description,comment:r?.comment,externalReferences:r?.externalReferences&&_.fromSpdxExternalPackageRefs(r.externalReferences),attributionTexts:r?.attributionTexts,primaryPackagePurpose:r?.primaryPackagePurpose?ln(r.primaryPackagePurpose):void 0,releaseDate:r?.releaseDate,builtDate:r?.builtDate,validUntilDate:r?.validUntilDate})}};var T=class{documentRefId;documentUri;checksum;constructor(e,r,n){if(!e.match(/^DocumentRef-[\da-zA-Z.+-]+$/))throw new Error(`DocumentRefId must only contain letters, numbers, ".", "-" and "+", and must start with "DocumentRef-, but is: ${e}.`);this.documentRefId=e,this.documentUri=r,this.checksum=n}static fromApi(e){return new T(e.documentRefId,e.documentUri,D.fromSpdxChecksum({checksumValue:e.checksumValue,checksumAlgorithm:e.checksumAlgorithm}))}};function mn(t){return`SPDX-${t??"2.3"}`}function pn(t){return`urn:${t.replace(/^[^A-Za-z0-9]+/,"").replace(/[^A-Za-z0-9-]/g,"-")||"document"}:${j()}`}var R=class{spdxVersion;dataLicense="CC0-1.0";spdxId;name;documentNamespace;externalDocumentRefs;licenseListVersion;creators;created;creatorComment;documentComment;constructor(e,r,n,i,o){this.spdxVersion=e,this.name=r,this.documentNamespace=n,this.creators=i,this.created=o?.created??new Date,this.externalDocumentRefs=o?.externalDocumentRefs??[],this.creatorComment=o?.creatorComment??void 0,this.licenseListVersion=o?.licenseListVersion??void 0,this.documentComment=o?.documentComment??void 0,this.spdxId=o?.spdxId??"SPDXRef-DOCUMENT"}static fromApi(e,r){return new R(mn(r?.spdxVersion),e,r?.namespace??pn(e),r?.creators?h.fromSpdxActors(r.creators).concat(h.tools()):[h.tools()],{...r,externalDocumentRefs:r?.externalDocumentRefs?r.externalDocumentRefs.map(n=>T.fromApi(n)):void 0})}};var Ve=(s=>(s.OTHER="OTHER",s.DOCUMENTATION="DOCUMENTATION",s.IMAGE="IMAGE",s.VIDEO="VIDEO",s.ARCHIVE="ARCHIVE",s.SPDX="SPDX",s.APPLICATION="APPLICATION",s.SOURCE="SOURCE",s.BINARY="BINARY",s.TEXT="TEXT",s.AUDIO="AUDIO",s))(Ve||{});function gn(t){let e=Ve[t];if(!e)throw new Error("Invalid file type: "+t);return e}var F=class{name;spdxId;checksums;fileTypes;licenseConcluded;licenseInfoInFiles;licenseComment;copyrightText;comment;notice;contributors;attributionTexts;constructor(e,r,n){this.name=e,this.spdxId=n?.spdxId??"SPDXRef-"+j(),this.checksums=r,this.fileTypes=n?.fileTypes??[],this.licenseConcluded=n?.licenseConcluded??void 0,this.licenseInfoInFiles=n?.licenseInfoInFiles??[],this.licenseComment=n?.licenseComment??void 0,this.copyrightText=n?.copyrightText??void 0,this.comment=n?.comment??void 0,this.notice=n?.notice??void 0,this.contributors=n?.contributors??[],this.attributionTexts=n?.attributionTexts??[]}static fromApi(e,r,n){return new F(e,D.fromSpdxChecksums(r),{spdxId:n?.spdxId??void 0,fileTypes:n?.fileTypes?n.fileTypes.map(i=>gn(i)):void 0,licenseConcluded:n?.licenseConcluded&&P(n.licenseConcluded),licenseInfoInFiles:n?.licenseInfoInFiles?.map(i=>P(i)),licenseComment:n?.licenseComment??void 0,copyrightText:n?.copyrightText&&P(n.copyrightText),comment:n?.comment??void 0,notice:n?.notice??void 0,contributors:n?.contributors??[],attributionTexts:n?.attributionTexts??[]})}};var L=class extends A{static createDocument(e,r){let n=R.fromApi(e,r);return new L(n)}addPackage(e,r){let n=N.fromApi(e,r);return this.packages.push(n),n}addFile(e,r,n){let i=F.fromApi(e,r,n);return this.files.push(i),i}addRelationship(e,r,n,i){let o=C.fromApi(e,r,n,i);return this.relationships.push(o),this}validate(e=!0){let r=this.collectValidationIssues();if(r.length>0){let n="Document is invalid: "+r.join(`
`);if(!e)throw new Error(n);console.error(n)}else console.log("Document is valid")}async write(e,r=!1){this.validate(r),await this.writeFile(e)}writeSync(e,r=!1){this.validate(r),this.writeFile(e).then(()=>{console.log("Wrote SBOM successfully: "+e)}).catch(n=>{console.error("Error writing sample SBOM: "+n)})}};function xn(t){return parseInt(t.split(".")[0])}function gt(t,e){let r=e?.spdxVersion;if(!r||xn(r)===2)return L.createDocument(t,e);throw new Error("Unsupported SPDX version")}var wt=m("clipanion");var x=m("@yarnpkg/core"),Et=m("@yarnpkg/cli");var Z={};re(Z,{_getYarnStateAliases:()=>Dt,fs:()=>Sn,getPackagePath:()=>Dn});var w=m("@yarnpkg/core"),xt=m("@yarnpkg/parsers"),y=m("@yarnpkg/fslib");var z=()=>({os:[process.platform],cpu:[process.arch],libc:[]});var Dn=async(t,e)=>{if(await Pn(t),!w.structUtils.isPackageCompatible(e,z()))return null;let r=w.structUtils.convertPackageToLocator(e),n=w.structUtils.stringifyLocator(r),i=De[n]||ht[n];if(!i)return null;let o=i.locations[0];return o?y.ppath.join(t.cwd,o):t.cwd},De,ht,Pn=async t=>{if(!De){let e=y.ppath.join(t.configuration.projectCwd,y.Filename.nodeModules,".yarn-state.yml");De=(0,xt.parseSyml)(await y.xfs.readFilePromise(e,"utf8")),ht=Dt(De)}},Sn=y.xfs,Dt=t=>Object.entries(t).reduce((e,[r,n])=>{if(!n.aliases)return e;let i=w.structUtils.parseLocator(r);for(let o of n.aliases){let c=w.structUtils.makeLocator(i,o),a=w.structUtils.stringifyLocator(c);e[a]=n}return e},{});var Ue={};re(Ue,{fs:()=>En,getPackagePath:()=>In});var Q=m("@yarnpkg/core"),M=m("@yarnpkg/fslib");var In=async(t,e)=>{if(!Q.structUtils.isPackageCompatible(e,z()))return null;let r=Q.structUtils.convertPackageToLocator(e),n=Q.structUtils.slugifyLocator(r),i=Q.structUtils.stringifyIdent(r),o=t.tryWorkspaceByLocator(r);return o?o.cwd:M.ppath.join(t.configuration.projectCwd,M.Filename.nodeModules,".store",n,M.Filename.nodeModules,i)},En=M.xfs;var qe={};re(qe,{fs:()=>Se,getFs:()=>An,getPackagePath:()=>kn});var Pt=m("@yarnpkg/plugin-pnp"),Pe=m("@yarnpkg/core"),St=m("@yarnpkg/fslib"),Ie=m("@yarnpkg/libzip");var kn=async(t,e)=>{if(yn(t),!Pe.structUtils.isPackageCompatible(e,z()))return null;let r=Pe.structUtils.convertPackageToLocator(e),n={name:Pe.structUtils.stringifyIdent(r),reference:r.reference},i=He.getPackageInformation(n);if(!i)return null;let{packageLocation:o}=i;return o},He,yn=t=>{He||(He=module.require((0,Pt.getPnpPath)(t).cjs))},An=()=>(Cn(),Se),Se,Cn=()=>{Se||(Se=new St.VirtualFS({baseFs:new Ie.ZipOpenFS({libzip:(0,Ie.getLibzipSync)(),readOnlyArchives:!0})}))};var It=t=>{switch(t){case"pnp":return qe;case"node-modules":return Z;case"pnpm":return Ue;default:throw new Error("Unsupported linker")}};async function kt(t){let e=await x.Configuration.find(t.context.cwd,t.context.plugins),{project:r,workspace:n}=await x.Project.find(e,t.context.cwd);if(!n)throw new Et.WorkspaceRequiredError(r.cwd,t.context.cwd);return await r.restoreInstallState(),[r,n]}function yt(t){let e=t.configuration.get("nodeLinker"),r;return typeof e=="string"?r=It(e):r=Z,r}var At=t=>{let e=new Set;for(let r of t.workspaces)r.manifest.devDependencies.forEach((n,i)=>{e.add(i)});return e},Ct=async t=>{for(let n of t.workspaces)n.manifest.devDependencies.clear();let e=await x.Cache.find(t.configuration),r=new x.ThrowReport;await t.resolveEverything({report:r,cache:e})},Be=async t=>{let e=new Map,r=t.storedDescriptors.values(),n=x.miscUtils.sortMap(r,[o=>x.structUtils.stringifyIdent(o),o=>x.structUtils.isVirtualDescriptor(o)?"0":"1",o=>o.range]),i=new Set;for(let o of n.values()){let c=t.storedResolutions.get(o.descriptorHash);if(!c)continue;let a=t.storedPackages.get(c);if(!a)continue;let{descriptorHash:l}=x.structUtils.isVirtualDescriptor(o)?x.structUtils.devirtualizeDescriptor(o):o;i.has(l)||(i.add(l),e.set(o,a))}return e};var Ee=m("@yarnpkg/fslib"),vn="NOASSERTION",On="SPDXRef-",_n="DESCRIBES",Nn="DEPENDS_ON",Tn="DEV_DEPENDENCY_OF",vt="(http:\\/\\/www\\.|https:\\/\\/www\\.|http:\\/\\/|https:\\/\\/|ssh:\\/\\/|git:\\/\\/|svn:\\/\\/|sftp:\\/\\/|ftp:\\/\\/)?([\\w\\-.!~*'()%;:&=+$,]+@)?[a-z0-9]+([\\-\\.]{1}[a-z0-9]+){0,100}\\.[a-z]{2,5}(:[0-9]{1,5})?(\\/.*)?",Rn="(git|hg|svn|bzr)",Fn="(git\\+git@[a-zA-Z0-9\\.\\-]+:[a-zA-Z0-9/\\\\.@\\-]+)",Ln="(bzr\\+lp:[a-zA-Z0-9\\.\\-]+)",wn="^((("+Rn+"\\+)?"+vt+")|"+Fn+"|"+Ln+")$",Mn=new RegExp(vt),bn=new RegExp(wn);function Vn(t){return t&&typeof t=="object"&&Un(t.url)?t.url:t&&typeof t=="object"?void 0:vn}function Un(t){return Mn.test(t)&&bn.test(t)}function ee(t){let e=t.name.replace(/^@/,"").replace(/_/g,"-"),r=t.version.replace(/\//g,".").replace(/_/g,"-");return On+e+"-"+r}async function ke(t,e,r,n,i){for(let[,o]of t.entries()){if(!o)continue;let c=await n.getPackagePath(r,o);if(c===null)return;let a=JSON.parse(await n.fs.readFilePromise(Ee.ppath.join(c,Ee.Filename.manifest),"utf8")),{repository:l}=a,u=Vn(l),f=ee(o);if(i.has(f))return;i.add(f),e.addPackage(o.name,{...u!==void 0&&{downloadLocation:u},spdxId:f})}}function Ot(t,e,r){for(let[,n]of t.entries()){let i=ee(n);r.has(i)&&e.addRelationship(e,i,_n)}}function _t(t,e,r,n,i){for(let[,o]of t.entries()){let c=ee(o);for(let[a,l]of o.dependencies.entries()){if(!i.has(a))continue;let u=Tt(r,l);!u||!n.has(u)||!n.has(c)||e.addRelationship(u,c,Tn)}}}function Nt(t,e,r,n){for(let[,i]of t.entries()){let o=ee(i);for(let[,c]of i.dependencies.entries()){let a=Tt(r,c);!a||!n.has(a)||!n.has(o)||e.addRelationship(o,a,Nn)}}}function Tt(t,e){let r=t.storedResolutions.get(e.descriptorHash);if(!r)return;let n=t.storedPackages.get(r);if(!!n)return ee(n)}function Rt(t,e){let r=new Map;for(let[n,i]of t.entries())Hn(e,n)&&r.set(n,i);return r}function Hn(t,e){return!t.includes(e.identHash)}function Ft(t,e,r){let n=new Map;for(let[,i]of t.entries())for(let[o,c]of i.dependencies.entries())r.has(o)&&n.set(c,e.get(c));return n}var qn=".spdx.json",G=class extends Lt.BaseCommand{async execute(){let[e,r]=await kt(this),n=yt(e),i=gt(r.manifest.name?.name??"spdx"),o=new Set,c=At(e),a=await Be(e),l=[...a].flatMap(([,d])=>[...d.dependencies].flatMap(([,ye])=>ye.identHash)),u=Rt(a,l),f=Ft(u,a,c);await ke(u,i,e,n,o),Ot(u,i,o),await ke(f,i,e,n,o),_t(u,i,e,o,c),await Ct(e);let s=await Be(e);await ke(s,i,e,n,o),Nt(s,i,e,o),i.writeSync((r.manifest.name?.name??"")+qn)}};G.paths=[["spdx"]],G.usage=wt.Command.Usage({description:"Generate SPDX document for the project",details:`
        This command generates an SPDX document for the project. The document will be placed in the root of the project.`,examples:[["Generate SPDX document","$0 spdx"]]});var Bn={commands:[G]},Yn=Bn;return er(Xn);})();
return plugin;
}
};
