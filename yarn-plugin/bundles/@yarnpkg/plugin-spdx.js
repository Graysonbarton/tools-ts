/* eslint-disable */
//prettier-ignore
module.exports = {
name: "@yarnpkg/plugin-spdx",
factory: function (require) {
var plugin=(()=>{var Gt=Object.create;var te=Object.defineProperty;var Kt=Object.getOwnPropertyDescriptor;var Wt=Object.getOwnPropertyNames;var Zt=Object.getPrototypeOf,$t=Object.prototype.hasOwnProperty;var m=(t=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(t,{get:(e,r)=>(typeof require<"u"?require:e)[r]}):t)(function(t){if(typeof require<"u")return require.apply(this,arguments);throw new Error('Dynamic require of "'+t+'" is not supported')});var g=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),re=(t,e)=>{for(var r in e)te(t,r,{get:e[r],enumerable:!0})},Me=(t,e,r,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of Wt(e))!$t.call(t,i)&&i!==r&&te(t,i,{get:()=>e[i],enumerable:!(n=Kt(e,i))||n.enumerable});return t};var be=(t,e,r)=>(r=t!=null?Gt(Zt(t)):{},Me(e||!t||!t.__esModule?te(r,"default",{value:t,enumerable:!0}):r,t)),Qt=t=>Me(te({},"__esModule",{value:!0}),t);var Ce=g(Ae=>{"use strict";Object.defineProperty(Ae,"__esModule",{value:!0});Ae.default=rr;var er=tr(m("crypto"));function tr(t){return t&&t.__esModule?t:{default:t}}var ie=new Uint8Array(256),ne=ie.length;function rr(){return ne>ie.length-16&&(er.default.randomFillSync(ie),ne=0),ie.slice(ne,ne+=16)}});var Je=g(se=>{"use strict";Object.defineProperty(se,"__esModule",{value:!0});se.default=void 0;var nr=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;se.default=nr});var K=g(oe=>{"use strict";Object.defineProperty(oe,"__esModule",{value:!0});oe.default=void 0;var ir=sr(Je());function sr(t){return t&&t.__esModule?t:{default:t}}function or(t){return typeof t=="string"&&ir.default.test(t)}var ar=or;oe.default=ar});var Z=g(W=>{"use strict";Object.defineProperty(W,"__esModule",{value:!0});W.default=void 0;W.unsafeStringify=je;var cr=dr(K());function dr(t){return t&&t.__esModule?t:{default:t}}var p=[];for(let t=0;t<256;++t)p.push((t+256).toString(16).slice(1));function je(t,e=0){return p[t[e+0]]+p[t[e+1]]+p[t[e+2]]+p[t[e+3]]+"-"+p[t[e+4]]+p[t[e+5]]+"-"+p[t[e+6]]+p[t[e+7]]+"-"+p[t[e+8]]+p[t[e+9]]+"-"+p[t[e+10]]+p[t[e+11]]+p[t[e+12]]+p[t[e+13]]+p[t[e+14]]+p[t[e+15]]}function ur(t,e=0){let r=je(t,e);if(!(0,cr.default)(r))throw TypeError("Stringified UUID is invalid");return r}var lr=ur;W.default=lr});var Ge=g(ae=>{"use strict";Object.defineProperty(ae,"__esModule",{value:!0});ae.default=void 0;var fr=pr(Ce()),mr=Z();function pr(t){return t&&t.__esModule?t:{default:t}}var ze,ve,_e=0,Oe=0;function gr(t,e,r){let n=e&&r||0,i=e||new Array(16);t=t||{};let s=t.node||ze,o=t.clockseq!==void 0?t.clockseq:ve;if(s==null||o==null){let d=t.random||(t.rng||fr.default)();s==null&&(s=ze=[d[0]|1,d[1],d[2],d[3],d[4],d[5]]),o==null&&(o=ve=(d[6]<<8|d[7])&16383)}let c=t.msecs!==void 0?t.msecs:Date.now(),l=t.nsecs!==void 0?t.nsecs:Oe+1,u=c-_e+(l-Oe)/1e4;if(u<0&&t.clockseq===void 0&&(o=o+1&16383),(u<0||c>_e)&&t.nsecs===void 0&&(l=0),l>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");_e=c,Oe=l,ve=o,c+=122192928e5;let f=((c&268435455)*1e4+l)%4294967296;i[n++]=f>>>24&255,i[n++]=f>>>16&255,i[n++]=f>>>8&255,i[n++]=f&255;let a=c/4294967296*1e4&268435455;i[n++]=a>>>8&255,i[n++]=a&255,i[n++]=a>>>24&15|16,i[n++]=a>>>16&255,i[n++]=o>>>8|128,i[n++]=o&255;for(let d=0;d<6;++d)i[n+d]=s[d];return e||(0,mr.unsafeStringify)(i)}var xr=gr;ae.default=xr});var Ne=g(ce=>{"use strict";Object.defineProperty(ce,"__esModule",{value:!0});ce.default=void 0;var hr=Dr(K());function Dr(t){return t&&t.__esModule?t:{default:t}}function Pr(t){if(!(0,hr.default)(t))throw TypeError("Invalid UUID");let e,r=new Uint8Array(16);return r[0]=(e=parseInt(t.slice(0,8),16))>>>24,r[1]=e>>>16&255,r[2]=e>>>8&255,r[3]=e&255,r[4]=(e=parseInt(t.slice(9,13),16))>>>8,r[5]=e&255,r[6]=(e=parseInt(t.slice(14,18),16))>>>8,r[7]=e&255,r[8]=(e=parseInt(t.slice(19,23),16))>>>8,r[9]=e&255,r[10]=(e=parseInt(t.slice(24,36),16))/1099511627776&255,r[11]=e/4294967296&255,r[12]=e>>>24&255,r[13]=e>>>16&255,r[14]=e>>>8&255,r[15]=e&255,r}var Ir=Pr;ce.default=Ir});var Te=g(A=>{"use strict";Object.defineProperty(A,"__esModule",{value:!0});A.URL=A.DNS=void 0;A.default=Ar;var Sr=Z(),Er=kr(Ne());function kr(t){return t&&t.__esModule?t:{default:t}}function yr(t){t=unescape(encodeURIComponent(t));let e=[];for(let r=0;r<t.length;++r)e.push(t.charCodeAt(r));return e}var Ke="6ba7b810-9dad-11d1-80b4-00c04fd430c8";A.DNS=Ke;var We="6ba7b811-9dad-11d1-80b4-00c04fd430c8";A.URL=We;function Ar(t,e,r){function n(i,s,o,c){var l;if(typeof i=="string"&&(i=yr(i)),typeof s=="string"&&(s=(0,Er.default)(s)),((l=s)===null||l===void 0?void 0:l.length)!==16)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");let u=new Uint8Array(16+i.length);if(u.set(s),u.set(i,s.length),u=r(u),u[6]=u[6]&15|e,u[8]=u[8]&63|128,o){c=c||0;for(let f=0;f<16;++f)o[c+f]=u[f];return o}return(0,Sr.unsafeStringify)(u)}try{n.name=t}catch{}return n.DNS=Ke,n.URL=We,n}});var Ze=g(de=>{"use strict";Object.defineProperty(de,"__esModule",{value:!0});de.default=void 0;var Cr=vr(m("crypto"));function vr(t){return t&&t.__esModule?t:{default:t}}function _r(t){return Array.isArray(t)?t=Buffer.from(t):typeof t=="string"&&(t=Buffer.from(t,"utf8")),Cr.default.createHash("md5").update(t).digest()}var Or=_r;de.default=Or});var Qe=g(ue=>{"use strict";Object.defineProperty(ue,"__esModule",{value:!0});ue.default=void 0;var Nr=$e(Te()),Tr=$e(Ze());function $e(t){return t&&t.__esModule?t:{default:t}}var Rr=(0,Nr.default)("v3",48,Tr.default),Fr=Rr;ue.default=Fr});var et=g(le=>{"use strict";Object.defineProperty(le,"__esModule",{value:!0});le.default=void 0;var Lr=wr(m("crypto"));function wr(t){return t&&t.__esModule?t:{default:t}}var Mr={randomUUID:Lr.default.randomUUID};le.default=Mr});var nt=g(fe=>{"use strict";Object.defineProperty(fe,"__esModule",{value:!0});fe.default=void 0;var tt=rt(et()),br=rt(Ce()),Vr=Z();function rt(t){return t&&t.__esModule?t:{default:t}}function Ur(t,e,r){if(tt.default.randomUUID&&!e&&!t)return tt.default.randomUUID();t=t||{};let n=t.random||(t.rng||br.default)();if(n[6]=n[6]&15|64,n[8]=n[8]&63|128,e){r=r||0;for(let i=0;i<16;++i)e[r+i]=n[i];return e}return(0,Vr.unsafeStringify)(n)}var Hr=Ur;fe.default=Hr});var it=g(me=>{"use strict";Object.defineProperty(me,"__esModule",{value:!0});me.default=void 0;var qr=Br(m("crypto"));function Br(t){return t&&t.__esModule?t:{default:t}}function Yr(t){return Array.isArray(t)?t=Buffer.from(t):typeof t=="string"&&(t=Buffer.from(t,"utf8")),qr.default.createHash("sha1").update(t).digest()}var Xr=Yr;me.default=Xr});var ot=g(pe=>{"use strict";Object.defineProperty(pe,"__esModule",{value:!0});pe.default=void 0;var Jr=st(Te()),jr=st(it());function st(t){return t&&t.__esModule?t:{default:t}}var zr=(0,Jr.default)("v5",80,jr.default),Gr=zr;pe.default=Gr});var at=g(ge=>{"use strict";Object.defineProperty(ge,"__esModule",{value:!0});ge.default=void 0;var Kr="00000000-0000-0000-0000-000000000000";ge.default=Kr});var ct=g(xe=>{"use strict";Object.defineProperty(xe,"__esModule",{value:!0});xe.default=void 0;var Wr=Zr(K());function Zr(t){return t&&t.__esModule?t:{default:t}}function $r(t){if(!(0,Wr.default)(t))throw TypeError("Invalid UUID");return parseInt(t.slice(14,15),16)}var Qr=$r;xe.default=Qr});var dt=g(I=>{"use strict";Object.defineProperty(I,"__esModule",{value:!0});Object.defineProperty(I,"NIL",{enumerable:!0,get:function(){return sn.default}});Object.defineProperty(I,"parse",{enumerable:!0,get:function(){return dn.default}});Object.defineProperty(I,"stringify",{enumerable:!0,get:function(){return cn.default}});Object.defineProperty(I,"v1",{enumerable:!0,get:function(){return en.default}});Object.defineProperty(I,"v3",{enumerable:!0,get:function(){return tn.default}});Object.defineProperty(I,"v4",{enumerable:!0,get:function(){return rn.default}});Object.defineProperty(I,"v5",{enumerable:!0,get:function(){return nn.default}});Object.defineProperty(I,"validate",{enumerable:!0,get:function(){return an.default}});Object.defineProperty(I,"version",{enumerable:!0,get:function(){return on.default}});var en=k(Ge()),tn=k(Qe()),rn=k(nt()),nn=k(ot()),sn=k(at()),on=k(ct()),an=k(K()),cn=k(Z()),dn=k(Ne());function k(t){return t&&t.__esModule?t:{default:t}}});var Bn={};re(Bn,{default:()=>qn});var Ft=m("@yarnpkg/cli");function _(t){return t.toISOString().split(".")[0]+"Z"}var O=class{created;creators;comment;licenseListVersion;constructor(e,r,n,i){this.created=e,this.creators=r,this.comment=n,this.licenseListVersion=i}static fromDocument(e){return new O(_(e.creationInfo.created),e.creationInfo.creators.map(r=>r.toString()),e.creationInfo.creatorComment??void 0,e.creationInfo.licenseListVersion??void 0)}};var S=class{algorithm;checksumValue;constructor(e,r){this.algorithm=e,this.checksumValue=r}static fromChecksum(e){return new S(e.algorithm,e.value)}};var N=class{packageVerificationCodeValue;packageVerificationCodeExcludedFiles;constructor(e,r){this.packageVerificationCodeValue=e,this.packageVerificationCodeExcludedFiles=r}static fromPackageVerificationCode(e){return new N(e.value,e.excludedFiles)}};var T=class{comment;referenceCategory;referenceLocator;referenceType;constructor(e,r,n,i){this.referenceCategory=e,this.referenceLocator=r,this.referenceType=n,this.comment=i}static fromExternalPackageRef(e){return new T(e.category.toString(),e.locator,e.type,e.comment)}};var R=class{name;downloadLocation;SPDXID;filesAnalyzed;packageVerificationCode;checksums;licenseInfoFromFiles;externalRefs;attributionTexts;builtDate;comment;copyrightText;description;homepage;licenseComments;licenseConcluded;licenseDeclared;originator;packageFileName;primaryPackagePurpose;releaseDate;sourceInfo;summary;supplier;validUntilDate;versionInfo;constructor(e,r,n,i,s,o,c,l,u,f,a,d,ke,wt,Mt,bt,Vt,Ut,Ht,qt,Bt,Yt,Xt,Jt,jt,zt){this.name=e,this.downloadLocation=r,this.SPDXID=n,this.filesAnalyzed=i,this.packageVerificationCode=s,this.checksums=o,this.licenseInfoFromFiles=c,this.externalRefs=l,this.attributionTexts=u,this.builtDate=f,this.comment=a,this.copyrightText=d,this.description=ke,this.homepage=wt,this.licenseComments=Mt,this.licenseConcluded=bt,this.licenseDeclared=Vt,this.originator=Ut,this.packageFileName=Ht,this.primaryPackagePurpose=qt,this.releaseDate=Bt,this.sourceInfo=Yt,this.summary=Xt,this.supplier=Jt,this.validUntilDate=jt,this.versionInfo=zt}static fromPackage(e){let r=e.checksums.length>0?e.checksums.map(s=>S.fromChecksum(s)):void 0,n=e.verificationCode?N.fromPackageVerificationCode(e.verificationCode):void 0,i=e.externalReferences?.length>0?e.externalReferences.map(s=>T.fromExternalPackageRef(s)):void 0;return new R(e.name,e.downloadLocation.toString(),e.spdxId,e.filesAnalyzed,n,r,e.licenseInfoFromFiles.map(s=>s.toString()),i,e.attributionTexts.length>0?e.attributionTexts:void 0,e.builtDate?_(e.builtDate):void 0,e.comment,e.copyrightText?.toString(),e.description,e.homepage?.toString(),e.licenseComment,e.licenseConcluded?.toString(),e.licenseDeclared?.toString(),e.originator?.toString(),e.fileName,e.primaryPackagePurpose?.toString(),e.releaseDate?_(e.releaseDate):void 0,e.sourceInfo,e.summary,e.supplier?.toString(),e.validUntilDate?_(e.validUntilDate):void 0,e.version)}};var F=class{spdxElementId;relatedSpdxElement;relationshipType;comment;constructor(e,r,n,i){this.spdxElementId=e,this.comment=i,this.relatedSpdxElement=r,this.relationshipType=n}static fromRelationship(e){return new F(e.spdxElementId,e.relatedSpdxElementId,e.relationshipType)}};var L=class{checksum;externalDocumentId;spdxDocument;constructor(e,r,n){this.checksum=e,this.externalDocumentId=r,this.spdxDocument=n}static fromExternalDocumentRef(e){let r=S.fromChecksum(e.checksum);return new L(r,e.documentRefId,e.documentUri)}};var w=class{SPDXID;fileName;checksums;attributionTexts;comment;copyrightText;fileContributors;fileTypes;licenseComments;licenseConcluded;licenseInfoInFiles;noticeText;constructor(e,r,n,i,s,o,c,l,u,f,a,d){this.SPDXID=e,this.fileName=r,this.checksums=n,this.attributionTexts=i,this.comment=s,this.copyrightText=o,this.fileContributors=c,this.fileTypes=l,this.licenseComments=u,this.licenseConcluded=f,this.licenseInfoInFiles=a,this.noticeText=d}static fromFile(e){let r=e.checksums.map(s=>S.fromChecksum(s)),n=e.fileTypes.length>0?e.fileTypes.map(s=>s.toString()):void 0,i=e.licenseInfoInFiles.length>0?e.licenseInfoInFiles.map(s=>s.toString()):void 0;return new w(e.spdxId,e.name,r,e.attributionTexts.length>0?e.attributionTexts:void 0,e.comment,e.copyrightText?.toString(),e.contributors.length>0?e.contributors:void 0,n,e.licenseComment,e.licenseConcluded?.toString(),i,e.notice)}};var M=class{SPDXID;comment;creationInfo;dataLicense;externalDocumentRefs;name;spdxVersion;documentNamespace;packages;files;relationships;constructor(e,r,n,i,s,o,c,l,u,f,a){this.SPDXID=e,this.spdxVersion=r,this.name=n,this.documentNamespace=i,this.dataLicense=s,this.creationInfo=o,this.packages=c,this.files=l,this.relationships=u,this.externalDocumentRefs=f,this.comment=a}static fromDocument(e){let r=O.fromDocument(e),n=e.packages.length>0?e.packages.map(c=>R.fromPackage(c)):void 0,i=e.files.length>0?e.files.map(c=>w.fromFile(c)):void 0,s=e.relationships.length>0?e.relationships.map(c=>F.fromRelationship(c)):void 0,o=e.creationInfo.externalDocumentRefs?.length>0?e.creationInfo.externalDocumentRefs.map(c=>L.fromExternalDocumentRef(c)):void 0;return new M(e.creationInfo.spdxId,e.creationInfo.spdxVersion,e.creationInfo.name,e.creationInfo.documentNamespace,e.creationInfo.dataLicense,r,n,i,s,o,e.creationInfo.documentComment)}};var Ve=be(m("fs/promises"),1),b=class{creationInfo;packages;files;relationships;constructor(e,r){this.creationInfo=e,this.packages=r?.packages??[],this.files=r?.files??[],this.relationships=r?.relationships??[]}hasMissingDescribesRelationships(){let e=this.packages.length===1&&this.files.length===0,r=this.relationships.filter(i=>i.relationshipType==="DESCRIBES"),n=this.relationships.filter(i=>i.relationshipType==="DESCRIBED_BY");return!e&&r.length===0&&n.length===0}hasDuplicateSpdxIds(){let e=[];return this.packages.forEach(r=>{if(e.includes(r.spdxId))return!0;e.push(r.spdxId)}),this.files.forEach(r=>{if(e.includes(r.spdxId))return!0;e.push(r.spdxId)}),this.relationships.forEach(r=>{if(e.includes(r.spdxElementId))return!0;e.push(r.spdxElementId)}),!1}gatherValidationIssues(){let e=[];return this.creationInfo.spdxVersion!=="SPDX-2.3"&&e.push("Invalid SPDX version. Currently only SPDX-2.3 is supported."),this.hasMissingDescribesRelationships()&&e.push("Missing DESCRIBES or DESCRIBED_BY relationships.","Document must have at least one DESCRIBES and one DESCRIBED_BY relationship, if there is not exactly one package present."),this.hasDuplicateSpdxIds()&&e.push("Duplicate SPDX IDs for packages, files or relationships."),e}async writeFile(e){let r=M.fromDocument(this),n=JSON.stringify(r,null,2);await Ve.default.writeFile(e,n)}};function Ue(t){return typeof t=="string"?t:t instanceof b?t.creationInfo.spdxId:t.spdxId}var V=class{spdxElementId;relatedSpdxElementId;relationshipType;comment;constructor(e,r,n,i){this.spdxElementId=e,this.relatedSpdxElementId=r,this.relationshipType=n,this.comment=i?.comment}static fromApi(e,r,n,i){return new V(Ue(e),Ue(r),n,{comment:i?.comment})}};var He=(n=>(n.Person="Person",n.Organization="Organization",n.Tool="Tool",n))(He||{}),h=class{type;name;email;constructor(e,r,n){if(r==="Tool"&&n)throw new Error("Email must be undefined if actorType is Tool.");this.name=e,this.email=n??void 0,this.type=r}static fromSpdxActor(e){let r=He[e.type];if(!r)throw new Error("Invalid actor type: "+e.type);return new h(e.name,r,e.email)}static fromSpdxActors(e){return Array.isArray(e)?e.map(r=>h.fromSpdxActor(r)):[h.fromSpdxActor(e)]}static tools(){return new h("SPDX Tools TS","Tool")}toString(){return this.type.valueOf()+": "+this.name+(this.email?" ("+this.email+")":"")}};var qe=(a=>(a.SHA1="SHA1",a.BLAKE3="BLAKE3",a["SHA3-384"]="SHA3-384",a.SHA256="SHA256",a.SHA384="SHA384",a["BLAKE2b-512"]="BLAKE2b-512",a["BLAKE2b-256"]="BLAKE2b-256",a["SHA3-512"]="SHA3-512",a.MD2="MD2",a.ADLER32="ADLER32",a.MD4="MD4",a["SHA3-256"]="SHA3-256",a["BLAKE2b-384"]="BLAKE2b-384",a.SHA512="SHA512",a.MD6="MD6",a.MD5="MD5",a.SHA224="SHA224",a))(qe||{}),D=class{algorithm;value;constructor(e,r){this.algorithm=e,this.value=r}static fromSpdxChecksum(e){let r=qe[e.checksumAlgorithm];if(!r)throw new Error("Invalid checksum algorithm: "+e.checksumAlgorithm);return new D(r,e.checksumValue)}static fromSpdxChecksums(e){return Array.isArray(e)?e.map(r=>D.fromSpdxChecksum(r)):[D.fromSpdxChecksum(e)]}};var Be="NOASSERTION",Ye="NONE",U=class{toString(){return Be}},ye=class{toString(){return Ye}};function P(t,e){let r=n=>n;return t===Be?new U:t===Ye?new ye:e?e(t):r(t)}function Xe(t){if(!(t instanceof U||typeof t=="string"))throw new Error(`Invalid entry: ${t.toString()} is not allowed.`)}var E=be(dt(),1),wi=E.default.v1,Mi=E.default.v3,H=E.default.v4,bi=E.default.v5,Vi=E.default.NIL,Ui=E.default.version,Hi=E.default.validate,qi=E.default.stringify,Bi=E.default.parse;var ut=(i=>(i.OTHER="OTHER",i["PERSISTENT-ID"]="PERSISTENT-ID",i.PERSISTENT_ID="PERSISTENT_ID",i.SECURITY="SECURITY",i["PACKAGE-MANAGER"]="PACKAGE-MANAGER",i.PACKAGE_MANAGER="PACKAGE_MANAGER",i))(ut||{}),q=class{category;type;locator;comment;constructor(e,r,n,i){this.category=e,this.type=r,this.locator=n,this.comment=i}static fromSpdxExternalPackageRefs(e){return e.map(r=>{let n=ut[r.referenceCategory];if(!n)throw new Error("Invalid external package reference category: "+r.referenceCategory);return new q(n,r.referenceType,r.referenceLocator,r.comment)})}};var ft=(d=>(d.APPLICATION="APPLICATION",d.FRAMEWORK="FRAMEWORK",d.LIBRARY="LIBRARY",d.CONTAINER="CONTAINER",d.OPERATING_SYSTEM="OPERATING_SYSTEM",d.DEVICE="DEVICE",d.FIRMWARE="FIRMWARE",d.SOURCE="SOURCE",d.ARCHIVE="ARCHIVE",d.FILE="FILE",d.INSTALL="INSTALL",d.OTHER="OTHER",d))(ft||{});function un(t){let e=ft[t];if(!e)throw new Error("Invalid package purpose: "+t);return e}function lt(t){if(t)if(typeof t=="string"){let e=P(t);return Xe(e),e}else return h.fromSpdxActor(t);else return}var B=class{name;downloadLocation;spdxId;version;fileName;supplier;originator;filesAnalyzed;verificationCode;checksums;homepage;sourceInfo;licenseConcluded;licenseInfoFromFiles;licenseDeclared;licenseComment;copyrightText;summary;description;comment;externalReferences;attributionTexts;primaryPackagePurpose;releaseDate;builtDate;validUntilDate;constructor(e,r){this.name=e,this.downloadLocation=r?.downloadLocation??new U,this.spdxId=r?.spdxId??"SPDXRef-"+H(),this.version=r?.version??void 0,this.fileName=r?.fileName??void 0,this.supplier=r?.supplier??void 0,this.originator=r?.originator??void 0,this.filesAnalyzed=r?.filesAnalyzed??!1,this.verificationCode=r?.verificationCode??void 0,this.checksums=r?.checksums??[],this.homepage=r?.homepage??void 0,this.sourceInfo=r?.sourceInfo??void 0,this.licenseConcluded=r?.licenseConcluded??void 0,this.licenseInfoFromFiles=r?.licenseInfoFromFiles??[],this.licenseDeclared=r?.licenseDeclared??void 0,this.licenseComment=r?.licenseComment??void 0,this.copyrightText=r?.copyrightText??void 0,this.summary=r?.summary??void 0,this.description=r?.description??void 0,this.comment=r?.comment??void 0,this.externalReferences=r?.externalReferences??[],this.attributionTexts=r?.attributionTexts??[],this.primaryPackagePurpose=r?.primaryPackagePurpose??void 0,this.releaseDate=r?.releaseDate??void 0,this.builtDate=r?.builtDate??void 0,this.validUntilDate=r?.validUntilDate??void 0}static fromApi(e,r){return new B(e,{spdxId:r?.spdxId,version:r?.version,fileName:r?.fileName,downloadLocation:r?.downloadLocation&&P(r.downloadLocation),supplier:lt(r?.supplier),originator:lt(r?.originator),filesAnalyzed:r?.filesAnalyzed,verificationCode:r?.verificationCode,checksums:r?.checksums&&D.fromSpdxChecksums(r.checksums),homepage:r?.homepage&&P(r.homepage),sourceInfo:r?.sourceInfo,licenseConcluded:r?.licenseConcluded&&P(r.licenseConcluded),licenseInfoFromFiles:r?.licenseInfoFromFiles?.map(n=>P(n)),licenseDeclared:r?.licenseDeclared&&P(r.licenseDeclared),licenseComment:r?.licenseComment,copyrightText:r?.copyrightText&&P(r.copyrightText),summary:r?.summary,description:r?.description,comment:r?.comment,externalReferences:r?.externalReferences&&q.fromSpdxExternalPackageRefs(r.externalReferences),attributionTexts:r?.attributionTexts,primaryPackagePurpose:r?.primaryPackagePurpose?un(r.primaryPackagePurpose):void 0,releaseDate:r?.releaseDate,builtDate:r?.builtDate,validUntilDate:r?.validUntilDate})}};var Y=class{documentRefId;documentUri;checksum;constructor(e,r,n){if(!e.match(/^DocumentRef-[\da-zA-Z.+-]+$/))throw new Error(`DocumentRefId must only contain letters, numbers, ".", "-" and "+", and must start with "DocumentRef-, but is: ${e}.`);this.documentRefId=e,this.documentUri=r,this.checksum=n}static fromApi(e){return new Y(e.documentRefId,e.documentUri,D.fromSpdxChecksum({checksumValue:e.checksumValue,checksumAlgorithm:e.checksumAlgorithm}))}};function ln(t){return"SPDX-"+(t??"2.3")}function fn(t){return"urn:"+(t.replace(/^[^A-Za-z0-9]+/,"").replace(/[^A-Za-z0-9-]/g,"-")??"document")+":"+H()}var X=class{spdxVersion;dataLicense="CC0-1.0";spdxId;name;documentNamespace;externalDocumentRefs;licenseListVersion;creators;created;creatorComment;documentComment;constructor(e,r,n,i,s,o){this.spdxVersion=e,this.name=r,this.documentNamespace=n,this.creators=i,this.created=s,this.externalDocumentRefs=o?.externalDocumentRefs??[],this.creatorComment=o?.creatorComment??void 0,this.licenseListVersion=o?.licenseListVersion??void 0,this.documentComment=o?.documentComment??void 0,this.spdxId=o?.spdxId??"SPDXRef-DOCUMENT"}static fromApi(e,r){return new X(ln(r?.spdxVersion),e,r?.namespace??fn(e),r?.creators?h.fromSpdxActors(r.creators).concat(h.tools()):[h.tools()],r?.created??new Date,{...r,externalDocumentRefs:r?.externalDocumentRefs?r.externalDocumentRefs.map(n=>Y.fromApi(n)):void 0})}};var mt=(a=>(a.OTHER="OTHER",a.DOCUMENTATION="DOCUMENTATION",a.IMAGE="IMAGE",a.VIDEO="VIDEO",a.ARCHIVE="ARCHIVE",a.SPDX="SPDX",a.APPLICATION="APPLICATION",a.SOURCE="SOURCE",a.BINARY="BINARY",a.TEXT="TEXT",a.AUDIO="AUDIO",a))(mt||{});function mn(t){let e=mt[t];if(!e)throw new Error("Invalid file type: "+t);return e}var J=class{name;spdxId;checksums;fileTypes;licenseConcluded;licenseInfoInFiles;licenseComment;copyrightText;comment;notice;contributors;attributionTexts;constructor(e,r,n){this.name=e,this.spdxId="SPDXRef-"+H(),this.checksums=r,this.fileTypes=n?.fileTypes??[],this.licenseConcluded=n?.licenseConcluded??void 0,this.licenseInfoInFiles=n?.licenseInfoInFiles??[],this.licenseComment=n?.licenseComment??void 0,this.copyrightText=n?.copyrightText??void 0,this.comment=n?.comment??void 0,this.notice=n?.notice??void 0,this.contributors=n?.contributors??[],this.attributionTexts=n?.attributionTexts??[]}static fromApi(e,r,n){return new J(e,D.fromSpdxChecksums(r),{spdxId:n?.spdxId??void 0,fileTypes:n?.fileTypes?n.fileTypes.map(i=>mn(i)):void 0,licenseConcluded:n?.licenseConcluded&&P(n.licenseConcluded),licenseInfoInFiles:n?.licenseInfoInFiles?.map(i=>P(i)),licenseComment:n?.licenseComment??void 0,copyrightText:n?.copyrightText&&P(n.copyrightText),comment:n?.comment??void 0,notice:n?.notice??void 0,contributors:n?.contributors??[],attributionTexts:n?.attributionTexts??[]})}};var j=class extends b{static createDocument(e,r){let n=X.fromApi(e,r);return new j(n)}addPackage(e,r){let n=B.fromApi(e,r);return this.packages.push(n),n}addFile(e,r,n){let i=J.fromApi(e,r,n);return this.files.push(i),i}addRelationship(e,r,n,i){let s=V.fromApi(e,r,n,i);return this.relationships.push(s),this}validate(e=!0){let r=this.gatherValidationIssues();if(r.length>0){let n="Document is invalid: "+r.join(`
`);if(!e)throw new Error(n);console.error(n)}else console.log("Document is valid")}async write(e,r=!1){this.validate(r),await this.writeFile(e)}writeSync(e,r=!1){this.validate(r),this.writeFile(e).then(()=>{console.log("Wrote SBOM successfully: "+e)}).catch(n=>{console.error("Error writing sample SBOM: "+n)})}};function pn(t){return parseInt(t.split(".")[0])}function pt(t,e){let r=e?.spdxVersion;if(!r||pn(r)===2)return j.createDocument(t,e);throw new Error("Unsupported SPDX version")}var Lt=m("clipanion");var x=m("@yarnpkg/core"),St=m("@yarnpkg/cli");var $={};re($,{_getYarnStateAliases:()=>ht,fs:()=>Dn,getPackagePath:()=>xn});var C=m("@yarnpkg/core"),gt=m("@yarnpkg/parsers"),y=m("@yarnpkg/fslib");var z=()=>({os:[process.platform],cpu:[process.arch],libc:[]});var xn=async(t,e)=>{if(await hn(t),!C.structUtils.isPackageCompatible(e,z()))return null;let r=C.structUtils.convertPackageToLocator(e),n=C.structUtils.stringifyLocator(r),i=he[n]||xt[n];if(!i)return null;let s=i.locations[0];return s?y.ppath.join(t.cwd,s):t.cwd},he,xt,hn=async t=>{if(!he){let e=y.ppath.join(t.configuration.projectCwd,y.Filename.nodeModules,".yarn-state.yml");he=(0,gt.parseSyml)(await y.xfs.readFilePromise(e,"utf8")),xt=ht(he)}},Dn=y.xfs,ht=t=>Object.entries(t).reduce((e,[r,n])=>{if(!n.aliases)return e;let i=C.structUtils.parseLocator(r);for(let s of n.aliases){let o=C.structUtils.makeLocator(i,s),c=C.structUtils.stringifyLocator(o);e[c]=n}return e},{});var Re={};re(Re,{fs:()=>In,getPackagePath:()=>Pn});var Q=m("@yarnpkg/core"),v=m("@yarnpkg/fslib");var Pn=async(t,e)=>{if(!Q.structUtils.isPackageCompatible(e,z()))return null;let r=Q.structUtils.convertPackageToLocator(e),n=Q.structUtils.slugifyLocator(r),i=Q.structUtils.stringifyIdent(r),s=t.tryWorkspaceByLocator(r);return s?s.cwd:v.ppath.join(t.configuration.projectCwd,v.Filename.nodeModules,".store",n,v.Filename.nodeModules,i)},In=v.xfs;var Le={};re(Le,{fs:()=>Pe,getFs:()=>kn,getPackagePath:()=>Sn});var Dt=m("@yarnpkg/plugin-pnp"),De=m("@yarnpkg/core"),Pt=m("@yarnpkg/fslib"),Ie=m("@yarnpkg/libzip");var Sn=async(t,e)=>{if(En(t),!De.structUtils.isPackageCompatible(e,z()))return null;let r=De.structUtils.convertPackageToLocator(e),n={name:De.structUtils.stringifyIdent(r),reference:r.reference},i=Fe.getPackageInformation(n);if(!i)return null;let{packageLocation:s}=i;return s},Fe,En=t=>{Fe||(Fe=module.require((0,Dt.getPnpPath)(t).cjs))},kn=()=>(yn(),Pe),Pe,yn=()=>{Pe||(Pe=new Pt.VirtualFS({baseFs:new Ie.ZipOpenFS({libzip:(0,Ie.getLibzipSync)(),readOnlyArchives:!0})}))};var It=t=>{switch(t){case"pnp":return Le;case"node-modules":return $;case"pnpm":return Re;default:throw new Error("Unsupported linker")}};async function Et(t){let e=await x.Configuration.find(t.context.cwd,t.context.plugins),{project:r,workspace:n}=await x.Project.find(e,t.context.cwd);if(!n)throw new St.WorkspaceRequiredError(r.cwd,t.context.cwd);return await r.restoreInstallState(),[r,n]}function kt(t){let e=t.configuration.get("nodeLinker"),r;return typeof e=="string"?r=It(e):r=$,r}var yt=t=>{let e=new Set;for(let r of t.workspaces)r.manifest.devDependencies.forEach((n,i)=>{e.add(i)});return e},At=async t=>{for(let n of t.workspaces)n.manifest.devDependencies.clear();let e=await x.Cache.find(t.configuration),r=new x.ThrowReport;await t.resolveEverything({report:r,cache:e})},we=async t=>{let e=new Map,r=t.storedDescriptors.values(),n=x.miscUtils.sortMap(r,[s=>x.structUtils.stringifyIdent(s),s=>x.structUtils.isVirtualDescriptor(s)?"0":"1",s=>s.range]),i=new Set;for(let s of n.values()){let o=t.storedResolutions.get(s.descriptorHash);if(!o)continue;let c=t.storedPackages.get(o);if(!c)continue;let{descriptorHash:l}=x.structUtils.isVirtualDescriptor(s)?x.structUtils.devirtualizeDescriptor(s):s;i.has(l)||(i.add(l),e.set(s,c))}return e};var Se=m("@yarnpkg/fslib"),An="NOASSERTION",Cn="SPDXRef-",vn="DESCRIBES",_n="DEPENDS_ON",On="DEV_DEPENDENCY_OF",Ct="(http:\\/\\/www\\.|https:\\/\\/www\\.|http:\\/\\/|https:\\/\\/|ssh:\\/\\/|git:\\/\\/|svn:\\/\\/|sftp:\\/\\/|ftp:\\/\\/)?([\\w\\-.!~*'()%;:&=+$,]+@)?[a-z0-9]+([\\-\\.]{1}[a-z0-9]+){0,100}\\.[a-z]{2,5}(:[0-9]{1,5})?(\\/.*)?",Nn="(git|hg|svn|bzr)",Tn="(git\\+git@[a-zA-Z0-9\\.\\-]+:[a-zA-Z0-9/\\\\.@\\-]+)",Rn="(bzr\\+lp:[a-zA-Z0-9\\.\\-]+)",Fn="^((("+Nn+"\\+)?"+Ct+")|"+Tn+"|"+Rn+")$",Ln=new RegExp(Ct),wn=new RegExp(Fn);function Mn(t){return t&&typeof t=="object"&&bn(t.url)?t.url:t&&typeof t=="object"?void 0:An}function bn(t){return Ln.test(t)&&wn.test(t)}function ee(t){let e=t.name.replace(/^@/,"").replace(/_/g,"-"),r=t.version.replace(/\//g,".").replace(/_/g,"-");return Cn+e+"-"+r}async function Ee(t,e,r,n,i){for(let[,s]of t.entries()){if(!s)continue;let o=await n.getPackagePath(r,s);if(o===null)return;let c=JSON.parse(await n.fs.readFilePromise(Se.ppath.join(o,Se.Filename.manifest),"utf8")),{repository:l}=c,u=Mn(l),f=ee(s);if(i.has(f))return;i.add(f),e.addPackage(s.name,{...u!==void 0&&{downloadLocation:u},spdxId:f})}}function vt(t,e,r){for(let[,n]of t.entries()){let i=ee(n);r.has(i)&&e.addRelationship(e,i,vn)}}function _t(t,e,r,n,i){for(let[,s]of t.entries()){let o=ee(s);for(let[c,l]of s.dependencies.entries()){if(!i.has(c))continue;let u=Nt(r,l);!u||!n.has(u)||!n.has(o)||e.addRelationship(u,o,On)}}}function Ot(t,e,r,n){for(let[,i]of t.entries()){let s=ee(i);for(let[,o]of i.dependencies.entries()){let c=Nt(r,o);!c||!n.has(c)||!n.has(s)||e.addRelationship(s,c,_n)}}}function Nt(t,e){let r=t.storedResolutions.get(e.descriptorHash);if(!r)return;let n=t.storedPackages.get(r);if(!!n)return ee(n)}function Tt(t,e){let r=new Map;for(let[n,i]of t.entries())Vn(e,n)&&r.set(n,i);return r}function Vn(t,e){return!t.includes(e.identHash)}function Rt(t,e,r){let n=new Map;for(let[,i]of t.entries())for(let[s,o]of i.dependencies.entries())r.has(s)&&n.set(o,e.get(o));return n}var Un=".spdx.json",G=class extends Ft.BaseCommand{async execute(){let[e,r]=await Et(this),n=kt(e),i=pt(r.manifest.name?.name??"spdx"),s=new Set,o=yt(e),c=await we(e),l=[...c].flatMap(([,d])=>[...d.dependencies].flatMap(([,ke])=>ke.identHash)),u=Tt(c,l),f=Rt(u,c,o);await Ee(u,i,e,n,s),vt(u,i,s),await Ee(f,i,e,n,s),_t(u,i,e,s,o),await At(e);let a=await we(e);await Ee(a,i,e,n,s),Ot(a,i,e,s),i.writeSync((r.manifest.name?.name??"")+Un)}};G.paths=[["spdx"]],G.usage=Lt.Command.Usage({description:"Generate SPDX document for the project",details:`
        This command generates an SPDX document for the project. The document will be placed in the root of the project.`,examples:[["Generate SPDX document","$0 spdx"]]});var Hn={commands:[G]},qn=Hn;return Qt(Bn);})();
return plugin;
}
};
